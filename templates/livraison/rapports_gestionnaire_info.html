{% extends 'dashboards/base_gestionnaire_info.html' %}
{% load static %}

{% block title %}Rapports Livraisons - Gestionnaire Info{% endblock %}

{% block content %}
<div>
  <div class="mb-4 flex items-center justify-between">
    <h1 class="text-2xl font-bold text-gray-900">Rapports Livraisons Informatiques</h1>
    <a href="{% url 'livraison:liste_livraisons_gestionnaire_info' %}" class="px-3 py-2 text-xs rounded bg-gray-600 text-white">Retour</a>
  </div>

  <div class="grid grid-cols-1 md:grid-cols-4 gap-3 mb-4">
    <div class="kpi-card"><div class="text-xs text-gray-500">Total</div><div class="text-xl font-semibold">{{ total_livraisons }}</div></div>
    <div class="kpi-card"><div class="text-xs text-gray-500">Livrées</div><div class="text-xl font-semibold">{{ livraisons_livrees }}</div></div>
    <div class="kpi-card"><div class="text-xs text-gray-500">Conformes</div><div class="text-xl font-semibold">{{ livraisons_conformes }}</div></div>
    <div class="kpi-card"><div class="text-xs text-gray-500">PV reçus</div><div class="text-xl font-semibold">{{ pv_recus }}</div></div>
  </div>

  <div class="chart-card">
    <h2 class="text-lg font-semibold mb-3">Répartition</h2>
    <div class="grid grid-cols-1 md:grid-cols-2 gap-3 text-sm">
      <div>
        <div class="font-medium mb-2">Par statut</div>
        <ul class="list-disc ml-5">
          {% for s in livraisons_par_statut %}
          <li>{{ s.statut_livraison }}: {{ s.count }}</li>
          {% endfor %}
        </ul>
      </div>
      <div>
        <div class="font-medium mb-2">Top fournisseurs</div>
        <ul class="list-disc ml-5">
          {% for f in livraisons_par_fournisseur %}
          <li>{{ f.commande_informatique__fournisseur__nom }}: {{ f.count }}</li>
          {% endfor %}
        </ul>
      </div>
    </div>
  </div>
</div>
{% endblock %}
